# インターン掲示板 タスクリスト

## 認証機能

### 🟡 ユーザー認証の基本実装

- [~] ユーザー登録機能の実装

  - [x] Supabase認証の実装
  - [x] UserProfileテーブルとの連携
  - [x] 登録完了後の自動ログイン実装
  - 見積時間: 2時間

- [~] ログイン機能の改善
  - [x] ログイン後のリダイレクト先を掲示板トップページに変更
  - [x] エラーメッセージの日本語化
  - 見積時間: 1時間

### 🟢 ユーザー情報管理

- [~] ユーザー情報編集機能

  - [x] 編集フォームの作成
  - [x] バリデーション実装
  - [x] 確認画面の実装
  - 見積時間: 2時間

- [~] ユーザー退会機能
  - [x] 退会確認画面の実装
  - [x] 論理削除の実装
  - [x] 関連投稿の非表示設定
  - 見積時間: 1時間

## 掲示板機能

### 🔴 投稿機能の実装

- [~] 投稿作成機能

  - [x] 投稿フォームの作成
  - [x] バリデーション実装
  - [ ] プレビュー機能
  - 見積時間: 3時間

- [~] 投稿一覧表示
  - [x] ページネーション実装（10件/ページ）
  - [x] 投稿者情報の表示
  - [x] 日時フォーマットの整備
  - 見積時間: 2時間

### 🟡 投稿管理機能

- [~] 投稿編集機能

  - [x] 編集フォームの作成
  - [x] 投稿者のみ編集可能な制御
  - [ ] プレビュー機能
  - 見積時間: 1時間

- [~] 投稿削除機能
  - [x] 削除確認ダイアログ
  - [x] 投稿者のみ削除可能な制御
  - [x] 論理削除の実装
  - 見積時間: 0.5時間

### 🟢 返信機能

- [x] 返信投稿機能
  - [x] 返信フォームの作成
  - [x] 親投稿との関連付け
  - [x] 返信一覧の表示
  - 見積時間: 3時間
- [x] 🔴 返信の投稿ボタンの挙動を修正する
  - [x] Server Actionからリダイレクト削除による状態管理問題を修正
  - [x] finally ブロックでisLoading状態のリセットを保証
  - [x] 成功時のページリロード実装
  - 見積時間: 0.5時間
- [x] 🟡 返信の編集フォームを`reply-form`にする
  - [x] ReplyFormコンポーネントの編集対応拡張
  - [x] updateReply Server Actionの実装
  - [x] 編集ページでの返信/通常投稿の条件分岐実装
  - 見積時間: 1時間
- [ ] 🔴 投稿、返信の削除メソッドを修正する（現在はエラーが出ている）
  - 詳細な手順や注意点
  - 依存関係
  - 見積時間:
- [x] 🟢 ボタンを押した後、ローディングを追加する（useFormStatusを活用）
  - PostFormコンポーネントでuseFormStatusを使用したローディング状態の実装
  - SubmitButtonコンポーネントを作成してpending状態を管理
  - 手動のisLoading状態管理から自動的なフォーム状態管理に変更
  - テストファイルもuseFormStatusのモックに対応して修正
  - 見積時間: 1時間

## UI/UX改善

### 🟡 レイアウトとデザイン

- [~] 共通レイアウトの改善

  - [x] ヘッダーナビゲーションの整備
  - [ ] レスポンシブ対応
  - 見積時間: 2時間

- [~] フォームデザインの統一
  - [x] 入力フォームのスタイル統一
  - [x] エラー表示の改善
  - 見積時間: 1時間

### 🔴 投稿関連

- [x] 投稿作成時のエラーと保存の不一致
  - 投稿フォームから送信後、エラーが表示されるがDBには投稿が保存され一覧に表示される問題を調査し修正する。
  - 原因特定
  - 修正実装
  - 見積時間: 1時間

## テストとデバッグ

### 🔴 テストフレームワーク導入 - 完了 ✅

- [x] ユニットテストフレームワーク (Jest, React Testing Library) の導入 🔴

  - [x] Jest, @types/jest, ts-jest, @testing-library/react, @testing-library/jest-dom, jest-environment-jsdom のインストール
  - [x] jest.config.js の作成と設定
  - [x] jest.setup.js の作成と設定
  - [x] package.jsonへのテストスクリプト追加
  - [x] tsconfig.jsonに型定義追加
  - [x] モジュール解決エラーの修正
  - 見積時間: 2時間

- [x] テストファイル構造を `__tests__` ディレクトリに変更 🟢
  - [x] `lib/__tests__/mathUtils.test.ts` へ移動/作成
  - [x] `components/__tests__/Greeting.test.tsx` へ移動/作成
  - [x] `tsconfig.json` に `@testing-library/jest-dom` の型定義を追加
  - 見積時間: 1時間

### 🔴 基本コンポーネントのテスト - 完了 ✅

- [x] AuthButtonコンポーネントのユニットテスト 🔴

  - [x] 非同期サーバーコンポーネントのテスト手法習得
  - [x] 依存関係のモック戦略実装（@/lib/auth、@/utils/supabase/check-env-vars、@/app/actions/auth）
  - [x] 動的モック（getter使用）の実装
  - [x] 環境変数未設定時の表示とボタン無効化テスト
  - [x] ログイン時の表示（ユーザー名、プロフィール編集、ログアウト）テスト
  - [x] 未ログイン時の表示（ログイン・新規登録ボタン）テスト
  - [x] toBeDisabled()エラーの解決（Button asChild問題）
  - 実装ファイル: `components/__tests__/auth-button.test.tsx`
  - 見積時間: 3時間

- [x] ConfirmationPageコンポーネントのユニットテスト 🔴
  - [x] 汎用確認画面コンポーネントのテスト
  - [x] next/navigationのモック
  - [x] onConfirmプロパティのモック
  - [x] 基本表示、成功時処理、エラー時処理のテスト
  - [x] タイトル、説明、項目の表示確認
  - [x] ボタン（戻る、確認して保存）の表示確認
  - 実装ファイル: `components/__tests__/confirmation-page.test.tsx`
  - 見積時間: 2時間

### 🔴 認証システムのテスト (Week 1) - 完了 ✅

- [x] ログインページのユニットテスト 🔴

  - [x] フォーム要素の表示確認テスト
  - [x] 必須項目の設定確認テスト
  - [x] エラー・成功メッセージの表示テスト
  - [x] フォーム入力値の設定テスト
  - [x] Server Componentのテスト手法習得
  - [x] Server Actionsのモック
  - [x] Message型の正しい使用
  - 実装ファイル: `components/__tests__/auth/sign-in-page.test.tsx`
  - 見積時間: 2時間

- [x] 新規登録ページのユニットテスト 🔴

  - [x] フォーム要素の表示確認テスト
  - [x] 必須項目のバリデーションテスト
  - [x] メッセージ表示時の条件分岐テスト
  - [x] フォーム入力値の設定テスト
  - [x] 特別なケース（メッセージのみ表示）の確認
  - 実装ファイル: `components/__tests__/auth/sign-up-page.test.tsx`
  - 見積時間: 2時間

- [x] 新規登録確認ページのユニットテスト 🔴
  - [x] 確認画面の表示テスト
  - [x] 入力データの表示確認テスト
  - [x] パスワードマスク機能のテスト
  - 実装ファイル: `components/__tests__/auth/sign-up-confirm-page.test.tsx`
  - 見積時間: 1時間

### 🟡 CRUD操作のテスト (Week 2-3) - 完了 ✅

- [x] PostFormコンポーネントのユニットテスト (投稿作成・編集) 🟡

  - [x] 新規投稿フォームの表示テスト
  - [x] 編集フォームの表示テスト
  - [x] フォーム入力値の設定テスト
  - [x] 必須項目のバリデーションテスト
  - [x] 投稿成功時のリダイレクトテスト
  - [x] エラー時のメッセージ表示テスト
  - [x] ローディング状態のテスト
  - [x] フォームデータの検証テスト
  - 実装ファイル: `components/__tests__/post/post-form.test.tsx`
  - 見積時間: 2時間

- [x] PostsPageコンポーネントのユニットテスト (投稿一覧) 🟡

  - [x] 投稿一覧の表示テスト
  - [x] 空の状態の表示テスト
  - [x] ページネーションのテスト
  - [x] 権限チェック（編集・削除ボタンの表示）テスト
  - [x] 返信数の表示テスト
  - 実装ファイル: `components/__tests__/post/posts-page.test.tsx`
  - 見積時間: 2時間

- [x] PostDeleteのユニットテスト (投稿削除) 🟢

  - [x] 削除ルートハンドラのテスト
  - [x] 削除成功時のリダイレクトテスト
  - [x] 削除エラー時の処理テスト
  - [x] 権限チェックのテスト
  - [x] 削除フォームコンポーネントのテスト
  - 実装ファイル: `components/__tests__/post/post-delete.test.tsx`
  - 見積時間: 1時間

- [x] ReplyFormコンポーネントのユニットテスト (返信機能) 🟢
  - [x] 新規返信フォームの表示テスト
  - [x] 編集返信フォームの表示テスト
  - [x] 返信内容の入力テスト
  - [x] 返信成功時の処理テスト（フォームクリア・ページリロード）
  - [x] 編集成功時の処理テスト（リダイレクト）
  - [x] エラー時のメッセージ表示テスト
  - [x] ローディング状態のテスト
  - 実装ファイル: `components/__tests__/post/reply-form.test.tsx`
  - 見積時間: 1時間

### 🔴 テスト学習システム構築 - 完了 ✅

- [x] テスト練習問題生成システムの構築 🔴

  - [x] 完全版プロンプト作成（docs/prompts/test-practice-generator.md）
  - [x] 簡潔版プロンプト作成（docs/prompts/test-practice-generator-simple.md）
  - [x] プロンプト集ドキュメント作成（docs/prompts/README.md）
  - [x] 6段階のレベル構成設計
  - [x] カスタマイズ例とベストプラクティス
  - [x] 自動化された教材生成システム
  - 見積時間: 3時間

- [x] 学習記録システムの構築 🔴
  - [x] 包括的学習記録作成（docs/learning/2024-12-19-testing-fundamentals.md）
  - [x] 技術詳細ノート作成（docs/learning/technical-notes.md）
  - [x] 学習ディレクトリREADME作成（docs/learning/README.md）
  - [x] トラブルシューティング事例集
  - [x] モック戦略パターン集
  - [x] ベストプラクティス集
  - 見積時間: 2時間

### 🟢 次期テスト実装計画

- [ ] E2Eテスト（Cypress/Playwright）の導入 🟢

  - [ ] E2Eテストフレームワークの選定と導入
  - [ ] 認証フローのE2Eテスト
  - [ ] 投稿作成から削除までのE2Eテスト
  - [ ] CI/CDパイプラインへの統合
  - 見積時間: 4時間

- [ ] パフォーマンステストの実装 🟢

  - [ ] React Testing Libraryのパフォーマンステスト
  - [ ] レンダリング速度の測定
  - [ ] メモリリークの検出
  - 見積時間: 2時間

- [ ] テストカバレッジの向上 🟢
  - [ ] カバレッジ閾値の設定（80%以上）
  - [ ] 未テストコンポーネントの特定
  - [ ] 重要な機能の網羅的テスト
  - 見積時間: 3時間
